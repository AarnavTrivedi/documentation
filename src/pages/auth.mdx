export const description =
  'On this page, we’ll dive into the different message endpoints you can use to manage messages programmatically.'

# Auth

Auth routes are used to invite, register, manage, and authenticate users.

---

## Send an invitation to register {{ tag: 'POST', label: '/invitation' }}

<Row>
  <Col>

    This endpoint allows you to invite a user to register for Arguflow vault. The user will receive an email with a link to set their password.

    ### Required request body attributes

    <Properties>
      <Property name="email" type="string">
        The email address of the user you want to invite.
      </Property>
      <Property name="referral_tokens" type="string array">
        The referral tokens you want to associate with the user.
      </Property>
    </Properties>

    ### Response

    If the invitation is successfully sent, the response will be a 200 OK with no body.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/invitation">

    ```bash {{ title: 'cURL' }}
    curl -X POST \
      https://api.arguflow.com/invitation \
      -H 'Content-Type: application/json' \
      -H 'Cookie: ai-editor=your_cookie_value_here' \
      -d '{
          "email": "example@example.com",
          "referral_tokens": ["token1", "token2", "token3"]
        }'
    ```
    ```js
    fetch('https://api.arguflow.com/invitation', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Cookie': 'ai-editor=your_cookie_value_here'
      },
      body: JSON.stringify({
        email: 'example@example.com',
        referral_tokens: ['token1', 'token2', 'token3']
      })
    });
    ```
    </CodeGroup>

  </Col>
</Row>

---

## Register a user {{ tag: 'POST', label: '/register/{invitation_id}' }}

<Row>
  <Col>

    This endpoint allows a user to set their password after receiving an invitation email.

    ### Required request body attributes

    <Properties>
      <Property name="password" type="string">
        The password the user wants to set. Must be at least 8 characters.
      </Property>
      <Property name="password_confirmation" type="string">
        The password confirmation. Must match the password.
      </Property>
    </Properties>

     ### Response

    If the user is successfully registered, a **SlimUser** type will be returned with the following properties:

    <Properties>
      <Property name="id" type="string">
        The user id (UUID).
      </Property>
      <Property name="email" type="string">
        The user email.
      </Property>
      <Property name="username" type="string | null">
        The user's username.
      </Property>
      <Property name="website" type="string | null">
        The user's website.
      </Property>
      <Property name="visible_email" type="boolean">
        Whether the user's email is visible to other users. Must be true if username is null.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/register/{invitation_id}">

    ```bash {{ title: 'cURL' }}
    curl -X POST \
      https://api.arguflow.com/register/{invitation_id} \
      -H 'Content-Type: application/json' \
      -H 'Cookie: ai-editor=your_cookie_value_here' \
      -d '{
          "password": "password",
          "password_confirmation": "password"
        }'
    ```
    ```js
    fetch('https://api.arguflow.com/register/{invitation_id}', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Cookie': 'ai-editor=your_cookie_value_here'
      },
      body: JSON.stringify({
        password: 'password',
        password_confirmation: 'password'
      })
    });
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "00000000-0000-0000-0000-000000000000",
      "email": "test@test.com",
      "username": null,
      "website": null,
      "visible_email": true
    }
    ```

  </Col>
</Row>

---

## Retrieve a message {{ tag: 'GET', label: '/v1/messages/:id' }}

<Row>
  <Col>

    This endpoint allows you to retrieve a message by providing the message id. Refer to [the list](#the-message-model) at the top of this page to see which properties are included with message objects.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/v1/messages/SIuAFUNKdSYHZF2w">

    ```bash {{ title: 'cURL' }}
    curl https://api.protocol.chat/v1/messages/SIuAFUNKdSYHZF2w \
      -H "Authorization: Bearer {token}"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.messages.get('SIuAFUNKdSYHZF2w')
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.messages.get("SIuAFUNKdSYHZF2w")
    ```

    ```php
    $client = new \Protocol\ApiClient($token);

    $client->messages->get('SIuAFUNKdSYHZF2w');
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "SIuAFUNKdSYHZF2w",
      "conversation_id": "xgQQXg3hrtjh7AvZ",
      "contact": {
        "id": "WAz8eIbvDR60rouK",
        "username": "KevinMcCallister",
        "phone_number": "1-800-759-3000",
        "avatar_url": "https://assets.protocol.chat/avatars/kevin.jpg",
        "last_active_at": 705103200,
        "created_at": 692233200
      },
      "message": "I’m traveling with my dad. He’s at a meeting. I hate meetings.",
      "reactions": [],
      "attachments": [],
      "read_at": 705103200,
      "created_at": 692233200,
      "updated_at": 692233200
    }
    ```

  </Col>
</Row>

---

## Update a message {{ tag: 'PUT', label: '/v1/messages/:id' }}

<Row>
  <Col>

    This endpoint allows you to perform an update on a message. Examples of updates are adding a reaction, editing the message, or adding an attachment.

    ### Optional attributes

    <Properties>
      <Property name="message" type="string">
        The message content.
      </Property>
      <Property name="reactions" type="array">
        An array of reaction objects associated with the message.
      </Property>
      <Property name="attachments" type="array">
        An array of attachment objects associated with the message.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="PUT" label="/v1/messages/SIuAFUNKdSYHZF2w">

    ```bash {{ title: 'cURL' }}
    curl -X PUT https://api.protocol.chat/v1/messages/SIuAFUNKdSYHZF2w \
      -H "Authorization: Bearer {token}" \
      -d reactions[red_angry_face][]="KateMcCallister"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.messages.update('SIuAFUNKdSYHZF2w', {
        reactions: {
            red_angry_face: ['KateMcCallister']
        }
    })
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.messages.update("SIuAFUNKdSYHZF2w",
        reactions={"red_angry_face": ["KateMcCallister"]})
    ```

    ```php
    $client = new \Protocol\ApiClient($token);

    $client->messages->update('SIuAFUNKdSYHZF2w', [
      'reactions' => [
        'red_angry_face' => ['KateMcCallister'],
      ],
    ]);
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "SIuAFUNKdSYHZF2w",
      "conversation_id": "xgQQXg3hrtjh7AvZ",
      "contact": {
        "id": "WAz8eIbvDR60rouK",
        "username": "KevinMcCallister",
        "phone_number": "1-800-759-3000",
        "avatar_url": "https://assets.protocol.chat/avatars/buzzboy.jpg",
        "last_active_at": 705103200,
        "created_at": 692233200
      },
      "message": "I'm not apologizing. I'd rather kiss a toilet seat.",
      "reactions": [
        {
          "red_angry_face": [
            "KateMcCallister"
          ]
        }
      ],
      "attachments": [],
      "read_at": 705103200,
      "created_at": 692233200,
      "updated_at": 692233200
    }
    ```

  </Col>
</Row>

---

## Delete a message {{ tag: 'DELETE', label: '/v1/messages/:id' }}

<Row>
  <Col>

    This endpoint allows you to delete messages from your conversations. Note: This will permanently delete the message.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="DELETE" label="/v1/messages/SIuAFUNKdSYHZF2w">

    ```bash {{ title: 'cURL' }}
    curl -X DELETE https://api.protocol.chat/v1/messages/SIuAFUNKdSYHZF2w \
      -H "Authorization: Bearer {token}"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.messages.delete('SIuAFUNKdSYHZF2w')
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.messages.delete("SIuAFUNKdSYHZF2w")
    ```

    ```php
    $client = new \Protocol\ApiClient($token);

    $client->messages->delete('SIuAFUNKdSYHZF2w');
    ```

    </CodeGroup>

  </Col>
</Row>
